{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useEffect, useState } from 'react';\nimport { getLoggedinUser } from '../../helpers/api_helper';\nimport { useNavigate } from 'react-router-dom';\nexport const useFetch = ({\n  fetch,\n  variables,\n  transformData,\n  initialValues,\n  isGet = true,\n  onSuccess\n}) => {\n  _s();\n  const [data, setData] = useState(initialValues !== null && initialValues !== void 0 ? initialValues : []);\n  const [loading, setLoading] = useState(isGet);\n  const [error, setError] = useState(null);\n  const user = getLoggedinUser();\n  const navigate = useNavigate();\n  const fetchData = refetchVars => {\n    return new Promise(async (resolve, reject) => {\n      setLoading(true);\n      try {\n        var _transformData;\n        const response = await fetch(refetchVars !== null && refetchVars !== void 0 ? refetchVars : variables);\n        setData((_transformData = transformData === null || transformData === void 0 ? void 0 : transformData(response)) !== null && _transformData !== void 0 ? _transformData : response);\n        onSuccess === null || onSuccess === void 0 ? void 0 : onSuccess(response);\n        resolve(response); // Resuelve la promesa si todo va bien\n      } catch (error) {\n        var _user$data;\n        setError(error);\n        const refreshToken = user === null || user === void 0 ? void 0 : (_user$data = user.data) === null || _user$data === void 0 ? void 0 : _user$data.refresh_token;\n        if (error.status === 401 && refreshToken) {\n          try {\n            try {\n              const response = await fetchData(refetchVars !== null && refetchVars !== void 0 ? refetchVars : variables);\n              resolve(response); // Resuelve la promesa si todo va bien\n            } catch (error) {\n              console.log(error);\n              navigate('/');\n            }\n          } catch (error) {\n            console.log(error);\n            navigate('/');\n          }\n        }\n        reject(error); // Rechaza la promesa en caso de error\n      } finally {\n        setLoading(false);\n      }\n    });\n  };\n  useEffect(() => {\n    if (isGet) {\n      const fetch = async () => {\n        await fetchData();\n      };\n      fetch();\n    }\n  }, [isGet]);\n  return {\n    data,\n    loading,\n    error,\n    setData,\n    refetch: fetchData\n  };\n};\n_s(useFetch, \"dmkE+c4W29K4CY2Lhjzyq9xNfM8=\", false, function () {\n  return [useNavigate];\n});","map":{"version":3,"names":["useEffect","useState","getLoggedinUser","useNavigate","useFetch","fetch","variables","transformData","initialValues","isGet","onSuccess","_s","data","setData","loading","setLoading","error","setError","user","navigate","fetchData","refetchVars","Promise","resolve","reject","_transformData","response","_user$data","refreshToken","refresh_token","status","console","log","refetch"],"sources":["/home/joserevete/Documentos/minisplit/pagina/MiniSplitMaster-FrontEnd/src/common/hooks/useFetch.js"],"sourcesContent":["import { useEffect, useState } from 'react'\n\nimport { getLoggedinUser } from '../../helpers/api_helper'\nimport { useNavigate } from 'react-router-dom'\n\nexport const useFetch = ({\n  fetch,\n  variables,\n  transformData,\n  initialValues,\n  isGet = true,\n  onSuccess,\n}) => {\n  const [data, setData] = useState(initialValues ?? [])\n  const [loading, setLoading] = useState(isGet)\n  const [error, setError] = useState(null)\n  const user = getLoggedinUser()\n  const navigate = useNavigate()\n\n  const fetchData = refetchVars => {\n    return new Promise(async (resolve, reject) => {\n      setLoading(true)\n      try {\n        const response = await fetch(refetchVars ?? variables)\n        setData(transformData?.(response) ?? response)\n        onSuccess?.(response)\n        resolve(response) // Resuelve la promesa si todo va bien\n      } catch (error) {\n        setError(error)\n        const refreshToken = user?.data?.refresh_token\n        if (error.status === 401 && refreshToken) {\n          try {\n            try {\n              const response = await fetchData(refetchVars ?? variables)\n              resolve(response) // Resuelve la promesa si todo va bien\n            } catch (error) {\n              console.log(error)\n              navigate('/')\n            }\n          } catch (error) {\n            console.log(error)\n            navigate('/')\n          }\n        }\n        reject(error) // Rechaza la promesa en caso de error\n      } finally {\n        setLoading(false)\n      }\n    })\n  }\n\n  useEffect(() => {\n    if (isGet) {\n      const fetch = async () => {\n        await fetchData()\n      }\n      fetch()\n    }\n  }, [isGet])\n\n  return { data, loading, error, setData, refetch: fetchData }\n}\n"],"mappings":";AAAA,SAASA,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAE3C,SAASC,eAAe,QAAQ,0BAA0B;AAC1D,SAASC,WAAW,QAAQ,kBAAkB;AAE9C,OAAO,MAAMC,QAAQ,GAAGA,CAAC;EACvBC,KAAK;EACLC,SAAS;EACTC,aAAa;EACbC,aAAa;EACbC,KAAK,GAAG,IAAI;EACZC;AACF,CAAC,KAAK;EAAAC,EAAA;EACJ,MAAM,CAACC,IAAI,EAAEC,OAAO,CAAC,GAAGZ,QAAQ,CAACO,aAAa,aAAbA,aAAa,cAAbA,aAAa,GAAI,EAAE,CAAC;EACrD,MAAM,CAACM,OAAO,EAAEC,UAAU,CAAC,GAAGd,QAAQ,CAACQ,KAAK,CAAC;EAC7C,MAAM,CAACO,KAAK,EAAEC,QAAQ,CAAC,GAAGhB,QAAQ,CAAC,IAAI,CAAC;EACxC,MAAMiB,IAAI,GAAGhB,eAAe,CAAC,CAAC;EAC9B,MAAMiB,QAAQ,GAAGhB,WAAW,CAAC,CAAC;EAE9B,MAAMiB,SAAS,GAAGC,WAAW,IAAI;IAC/B,OAAO,IAAIC,OAAO,CAAC,OAAOC,OAAO,EAAEC,MAAM,KAAK;MAC5CT,UAAU,CAAC,IAAI,CAAC;MAChB,IAAI;QAAA,IAAAU,cAAA;QACF,MAAMC,QAAQ,GAAG,MAAMrB,KAAK,CAACgB,WAAW,aAAXA,WAAW,cAAXA,WAAW,GAAIf,SAAS,CAAC;QACtDO,OAAO,EAAAY,cAAA,GAAClB,aAAa,aAAbA,aAAa,uBAAbA,aAAa,CAAGmB,QAAQ,CAAC,cAAAD,cAAA,cAAAA,cAAA,GAAIC,QAAQ,CAAC;QAC9ChB,SAAS,aAATA,SAAS,uBAATA,SAAS,CAAGgB,QAAQ,CAAC;QACrBH,OAAO,CAACG,QAAQ,CAAC,EAAC;MACpB,CAAC,CAAC,OAAOV,KAAK,EAAE;QAAA,IAAAW,UAAA;QACdV,QAAQ,CAACD,KAAK,CAAC;QACf,MAAMY,YAAY,GAAGV,IAAI,aAAJA,IAAI,wBAAAS,UAAA,GAAJT,IAAI,CAAEN,IAAI,cAAAe,UAAA,uBAAVA,UAAA,CAAYE,aAAa;QAC9C,IAAIb,KAAK,CAACc,MAAM,KAAK,GAAG,IAAIF,YAAY,EAAE;UACxC,IAAI;YACF,IAAI;cACF,MAAMF,QAAQ,GAAG,MAAMN,SAAS,CAACC,WAAW,aAAXA,WAAW,cAAXA,WAAW,GAAIf,SAAS,CAAC;cAC1DiB,OAAO,CAACG,QAAQ,CAAC,EAAC;YACpB,CAAC,CAAC,OAAOV,KAAK,EAAE;cACde,OAAO,CAACC,GAAG,CAAChB,KAAK,CAAC;cAClBG,QAAQ,CAAC,GAAG,CAAC;YACf;UACF,CAAC,CAAC,OAAOH,KAAK,EAAE;YACde,OAAO,CAACC,GAAG,CAAChB,KAAK,CAAC;YAClBG,QAAQ,CAAC,GAAG,CAAC;UACf;QACF;QACAK,MAAM,CAACR,KAAK,CAAC,EAAC;MAChB,CAAC,SAAS;QACRD,UAAU,CAAC,KAAK,CAAC;MACnB;IACF,CAAC,CAAC;EACJ,CAAC;EAEDf,SAAS,CAAC,MAAM;IACd,IAAIS,KAAK,EAAE;MACT,MAAMJ,KAAK,GAAG,MAAAA,CAAA,KAAY;QACxB,MAAMe,SAAS,CAAC,CAAC;MACnB,CAAC;MACDf,KAAK,CAAC,CAAC;IACT;EACF,CAAC,EAAE,CAACI,KAAK,CAAC,CAAC;EAEX,OAAO;IAAEG,IAAI;IAAEE,OAAO;IAAEE,KAAK;IAAEH,OAAO;IAAEoB,OAAO,EAAEb;EAAU,CAAC;AAC9D,CAAC;AAAAT,EAAA,CAxDYP,QAAQ;EAAA,QAYFD,WAAW;AAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}